---

# ------------------------------------------------------------------------------
# File        : ctlabs-ansible/roles/ctlabs_bind/tasks/config.yml
# Description : configurations
# ------------------------------------------------------------------------------

- name: ctlabs_bind.tasks.config.master
  when: ansible_local.ctlabs_bind.type == 'master'
  block:
    - name: ctlabs_bind.tasks.config.named
      template:
        src  : master.named.conf.j2
        dest : "{{ ctlabs_bind.defaults.config.file }}"

    - name: ctlabs_bind.tasks.config.zones
      template:
        src  : zone.db.j2
        dest : "{{ ctlabs_bind.defaults.config.dir }}/data/{{ zone }}.db"
      loop: "{{ ctlabs_bind.defaults.config.zones }}"
      loop_control:
        loop_var: zone
      vars:
        zone_data: "{{ lookup('vars', 'zone_' + zone.replace('.', '_')) }}"
