---

# ------------------------------------------------------------------------------
# File        : ctlabs-ansible/roles/ctlabs_netbox/tasks/config.yml
# Description : configurations
# ------------------------------------------------------------------------------

- name: ctlabs_netbox.tasks.config.file
  template:
    src  : "{{ ctlabs_netbox.defaults.config.template }}"
    dest : "{{ ctlabs_netbox.defaults.config.file     }}"
  notify: ctlabs_netbox.handlers.service.restart

- name: ctlabs_netbox.tasks.config.netbox.sh
  copy: 
    src  : files/netbox.sh
    dest : /usr/bin/netbox.sh
    mode : '0750'

- name: ctlabs_netbox.tasks.config.housekeeping
  file:
    src  : /opt/netbox/contrib/netbox-housekeeping.sh
    dest : /etc/cron.daily/netbox-housekeeping
    state: link

- name: ctlabs_netbox.tasks.config.httpd
  copy:
    src  : files/netbox.conf
    dest : /etc/httpd/conf.d/netbox.conf

- name: ctlabs_netbox.tasks.config.update
  shell:
    cmd: /usr/bin/netbox.sh update

- name: ctlabs_netbox.tasks.config.admin.create
  shell:
    cmd: /usr/bin/netbox.sh admin
