---

# ------------------------------------------------------------------------------
# File        : ctlabs-ansible/roles/ctlabs_sssd/tasks/package.yml
# Description : main ctlabs_sssd tasks file.
# ------------------------------------------------------------------------------

- name: ctlabs_sssd.tasks.package.debian.cache.update
  when: ctg_os_family == "debian"
  apt:
    update_cache : true

- name: ctlabs_sssd.tasks.package.install
  package:
    name    : "{{ item.name }}"
    state : present
  loop    : "{{ ctlabs_sssd.defaults.pkgs[ctg_os_family] }}"
  when    : item.when is not defined or item.when
  register: result
  until   : result is success

- name: ctlabs_sssd.tasks.package.python.pips.install
  when: not ctg_os.startswith('kali')
  pip:
    name: "{{ item }}"
  loop: "{{ ctlabs_sssd.defaults.python.pips }}"
