---

# ------------------------------------------------------------------------------
# File        : ctlabs_atlantis/tasks/package.yml
# Description : packages
# ------------------------------------------------------------------------------

- name: ctlabs_atlantis.tasks.package.bindir
  file:
    path  : "{{ ctlabs_atlantis.defaults.pkgs.atlantis.bindir }}"
    state : directory

- name: ctlabs_atlantis.tasks.package.download
  get_url:
    url  : "{{ ctlabs_atlantis.defaults.pkgs.atlantis.url    }}"
    dest : "{{ ctlabs_atlantis.defaults.pkgs.atlantis.tmpzip }}"
  delegate_to: localhost

#- name: ctlabs_atlantis.tasks.package.copy
#  copy:
#    src : "{{ ctlabs_atlantis.defaults.pkgs.atlantis.tmpzip }}"
#    dest: "{{ ctlabs_atlantis.defaults.pkgs.atlantis.tmpzip }}"

- name: ctlabs_atlantis.tasks.package.unzip
  unarchive:
    src  : "{{ ctlabs_atlantis.defaults.pkgs.atlantis.tmpzip }}"
    dest : "{{ ctlabs_atlantis.defaults.pkgs.atlantis.bindir }}"
#    remote_src: true

#- name: ctlabs_atlantis.tasks.package.install
#  file:
#    src   : "{{ ctlabs_atlantis.defaults.pkgs.atlantis.dir + '/' + ctlabs_atlantis.defaults.pkgs.name + '-' + ctlabs_atlantis.defaults.pkgs.version }}"
#    dest  : "{{ ctlabs_atlantis.defaults.pkgs.atlantis.dir + '/' + ctlabs_atlantis.defaults.pkgs.name }}"
#    state : link

- name: ctlabs_atlantis.tasks.package.group
  group:
    name   : "{{ ctlabs_atlantis.defaults.service.group }}"
    system : true

- name: ctlabs_atlantis.tasks.package.user
  user:
    name   : "{{ ctlabs_atlantis.defaults.service.user  }}"
    group  : "{{ ctlabs_atlantis.defaults.service.group }}"
    system : true
